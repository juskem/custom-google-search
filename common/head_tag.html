<script type="text/x-handlebars" data-template-name="components/google-search">
  <div>
    <form id='google-search-form'>
      <input type="text" name="q" value="{{searchTerm}}">
      <button type="button" class="btn btn-primary" id="search-button">+Podcast</button>
    </form>
  </div>
  
  <script type="text/javascript">
    // Adding the script directly inside the template to ensure it runs after the template is rendered
    document.addEventListener('DOMContentLoaded', function() {
      console.log("DOM fully loaded and parsed");
      
      const form = document.getElementById('google-search-form');
      const button = document.getElementById('search-button');
  
      if (!form) {
        console.error('Form with id "google-search-form" not found in the DOM.');
        return;
      }
      console.log("Form found:", form);
  
      button.addEventListener('click', function(event) {
        event.preventDefault();
  
        const searchTerm = form.querySelector('input[name="q"]').value;
  
        if (!searchTerm) {
          alert('Please enter a search term.');
          return;
        }
  
        const apiUrl = 'https://7cs72f6qgg.execute-api.eu-central-1.amazonaws.com/search?q=' + encodeURIComponent(searchTerm);
  
        fetch(apiUrl, {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json'
          }
        })
        .then(response => response.json())
        .then(data => {
          const url = data.url;
  
          if (url) {
            window.open(url, '_blank');
          } else {
            alert('No URL found in the response');
          }
        })
        .catch(error => {
          console.error('Error fetching the search result:', error);
        });
      });
    });
  </script>
  </script>
  